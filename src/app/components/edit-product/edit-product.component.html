<!-- {{msg}}
<form [formGroup]="editProductForm" (ngSubmit)="addProduct()">

    
    <input type="text" name="productName" formControlName="productName"> <br>
    <input type="text" name="price" formControlName="price"><br>
    <input type="submit" value="add Product" [disabled]="!editProductForm.valid">
</form> -->

<!-- This snippet uses Font Awesome 5 Free as a dependency. You can download it at fontawesome.io! -->

<body>
    <div class="container">
        <div class="row">
            <div class="col-sm-9 col-md-7 col-lg-5 mx-auto">
                <div class="card border-0 shadow rounded-3 my-5">
                    <div class="card-body p-4 p-sm-5">
                        <h5 class="card-title text-center fw-light fs-4">Edit Product</h5>
                        <hr>
                        <form [formGroup]="editProductForm" (ngSubmit)="editProduct()">

                            <div class="form mb-3">
                                <label>Product Id</label>
                                <input type="text" class="form-control" id="floatingInput" name="productId"
                                    formControlName="productId" [value]="product?.productId" readonly>


                            </div>
                            <div class="form mb-3">
                                <label>Product Name {{product.productName}}</label>
                                <input type="text" class="form-control" id="floatingInput" name="productName"
                                    formControlName="productName" [(ngModel)]="product.productName">
                                <p class="error " style="color: red;"
                                    *ngIf="editProductForm.controls['productName'].hasError('required') && editProductForm.controls['productName'].touched">
                                    Product name is required</p>

                            </div>
                            <div class="form mb-3">
                                <label>description</label>
                                <input type="text" class="form-control" id="floatingInput" name="description"
                                    formControlName="description" [(ngModel)]="product.description">
                                <p class="error " style="color: red;"
                                    *ngIf="editProductForm.controls['description'].hasError('required') && editProductForm.controls['description'].touched">
                                    description is required</p>

                            </div>

                            <div class="form mb-3">
                                <label>Price</label>
                                <input type="text" class="form-control" id="floatingInput" name="price"
                                    formControlName="price" [(ngModel)]="product.price">
                                <p class="error " style="color: red;"
                                    *ngIf="editProductForm.controls['price'].hasError('required') && editProductForm.controls['price'].touched">
                                    Price is required</p>
                            </div>
                            <!-- <div>
                                <label>Select Category : </label>
                                <select id="sort-by" class="form-select " style="margin: 5px;"
                                    formControlName="category" [(ngModel)]="product.category.mainCategory">
                                    <option selected disabled hidden>Select Category</option>
                                    <option *ngFor="let cateogry of categories" [value]="cateogry.categoryId">
                                        {{cateogry.categoryName}}</option>
                                </select>
                            </div> -->

                            <div>
                                <label>Main Category: {{mainCat}}</label>
                                <select class="form-select " formControlName="mainCategory"
                                    [(ngModel)]="selectedMainCategory"
                                    [(ngModel)]="product.category.mainCategory.categoryId"
                                    (change)="onMainCategoryChange()">
                                    <option *ngFor="let mainCategory of mainCategories"
                                        [value]="mainCategory.categoryId">{{ mainCategory.categoryName }}</option>
                                </select>
                            </div>

                            <div>
                                <label>Sub Category: {{subCat}}</label>
                                <select class="form-select " formControlName="subCategory"
                                    [(ngModel)]="selectedSubCategory"
                                    [(ngModel)]="product.category.subCategory.categoryId"
                                    (change)="onSubCategoryChange()">
                                    <option *ngFor="let subCategory of subCategories" [value]="subCategory.categoryId">
                                        {{ subCategory.categoryName }}</option>
                                </select>
                            </div>

                            <div *ngIf="secondaryCategories.length>0">
                                <label>Secondary Category: {{secondCat}}</label>
                                <select class="form-select " formControlName="secondaryCategory"
                                    [(ngModel)]="product.category.secondaryCategory">
                                    <option *ngFor="let secondaryCategory of secondaryCategories"
                                        [value]="secondaryCategory.categoryId">{{ secondaryCategory.categoryName }}
                                    </option>
                                </select>
                            </div>
                            <div *ngIf=" product.sizes">
                                <p>{{product.sizes}}</p>
                                <label>Sizes:</label>
                                <!-- <span *ngFor="let sizee of product.sizes" class="btn btn-size m-1  border border-1"
                                (click)="toggleSize(sizee)"
                                    [ngClass]="{'product-size': sizee, 'selected-size': selectedSize.includes(sizee)}">{{sizee}}
                                </span> -->
                                <span class="btn btn-size m-1  border border-1" *ngFor="let size of sizes"
                                    (click)="toggleSize(size)"
                                    [ngClass]="{'selected-size': selectedSize.includes(size)}">
                                    <!-- 'product-size': product.sizes.includes(size)}" -->
                                    <!-- ,'product-size': selectedSize.includes(size)}" -->

                                    {{ size }}
                                </span>
                            </div>

                            <div *ngIf=" product.sizes">
                                <label>Sizes:</label>
                                <span *ngFor="let size of sizes" class="btn btn-size m-1 border border-1" [ngClass]="{
                                        'product-size': product.sizes.includes(size),
                                        'selected-size': selectedSizee === size
                                      }" (click)="toggleSize1(size)">
                                    {{ size }}
                                </span>
                            </div>
                            <div *ngIf=" product.sizes">
                                <label>Sizes:</label>
                                <div class="btn-group" role="group">
                                    <button type="button" *ngFor="let size of sizes"
                                        class="btn btn-size m-1 border border-1"
                                        [ngClass]="{'product-size': product.sizes.includes(size), 'selected-size': selectedSize.includes(size)}"
                                        (click)="toggleSize(size)">
                                        {{ size }}
                                    </button>
                                </div>
                            </div>
                            <div *ngIf=" product.sizes">
                                <label>Sizes:</label>
                                <div class="btn-group" role="group">
                                    <button type="button" *ngFor="let size of sizes"
                                        class="btn btn-size m-1 border border-1"
                                        [ngClass]="{'product-size': isSelectedSize(size), 'selected-size': selectedSize.includes(size)}"
                                        (click)="toggleSize(size)">
                                        {{ size }}
                                    </button>
                                </div>
                            </div>



                            <div class="col-md">
                                <label for="image">Image :</label>
                            </div>
                            <div class="col-md">
                                <img [src]="getImageUrl(product?.image)" class="img-fluid rounded-start" alt="...">
                            </div>
                            <br>
                            <div>
                                <input type="file" id="image" class="form-control" (change)="onFileSelected($event)"
                                    required>
                            </div>
                            <br>
                            <div class="col-md" *ngIf="imageUrl">

                                <img [src]="imageUrl" class="img-fluid rounded-start" alt="Selected Image" />
                            </div>


                            <div class="d-grid">
                                <button class="btn btn-primary btn-login text-uppercase fw-bold" type="submit"
                                    [disabled]="!editProductForm.valid">Update Product</button>
                            </div>

                        </form>
                        <div class="d-grid">
                            <button class="btn btn-primary btn-login text-uppercase fw-bold"> <a
                                    href="admin-dashboard"></a> BACK</button>
                        </div>
                        <a href="admin-dashboard"> <button class="btn btn-primary">Back</button> </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>